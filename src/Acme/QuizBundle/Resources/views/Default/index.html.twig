{% extends '::base.html.twig' %}

{% block body %}
<div class="container">
    
    <h1>Quiz</h1>
    
    {% if qa is not empty %}

        <p>Single or multiple answers for each question. {{ pagination.getTotalItemCount }} questions available</p>

        <div>Order by {{ knp_pagination_sortable(pagination, 'Id', 'qq.id') }} - {% if pagination.isSorted('qq.question') %}{% endif %}{{ knp_pagination_sortable(pagination, 'Question', 'qq.question') }}</div>
        <div>&nbsp;</div>
        <div>&nbsp;</div>
        
        {% for question in qa %}
        <form action="" method="post" id="frm_question_{{ question.id }}">
            <strong>{{ question.question }}</strong><br>
            {% if question.questionCodePart|length > 0 %}
            <pre>{{ question.questionCodePart|escape('html') }}</pre>
            {% endif %}

            {% set answer_number = 1 %}
            {% for answer in question.answers %}

                {% if question.numberCorrectAnswers > 1 %}
                <div class="checkbox">
                    <label for="answer_{{ answer.id }}">
                        <input type="checkbox" name="answer_{{ answer.id }}" id="answer_{{ answer.id }}" value="1"{% if answer.correct == 1 %} correct="correct"{% endif %}> {{ answer.answer }}
                    </label>
                </div>
                {% else %}
               <div class="radio">
                    <label for="answer_{{ answer.id }}">
                        <input type="radio" name="answer" id="answer_{{ answer.id }}" value=""{% if answer.correct == 1 %} correct="correct"{% endif %}> {{ answer.answer }}
                    </label>
                </div>
                {% endif %}
                {% set answer_number = answer_number + 1 %}
            {% endfor %}
            <p class="text-right">Choose {{ question.numberCorrectAnswers }} answers</p>
            <p class="text-center"><button class="btn btn-primary" type="button" onclick="solve('frm_question_{{ question.id }}', 1)">Solve</button></p>
            <hr>
        </form>
        {% endfor %}

    <div class="navigation">
        {{ knp_pagination_render(pagination) }}
    </div>
    
    {% else %}
        <div class="alert alert-warning">
            <h2>No questions</h2>
            <p>Sorry, no questions are available for now :(</p>
        </div>
    {% endif %}
    
<hr>

<div>2014 <a href="http://www.andreafiori.net" title="Andrea Fiori's website" target="_blank">Andrea Fiori</a></div>

</div>

<script>

function solve(formId, answers) {

    checkCorrectAnswer( $("#"+formId+" input:checkbox") );
    
    checkCorrectAnswer( $("#"+formId+" input:radio") );
    
}

function checkCorrectAnswer(selector) {
    
    if ( selector.length > 0 ) {
        selector.each(function( i ) {
            if (this.getAttribute('correct') === 'correct') {
                this.checked = true;
            }
        });
    }
    
}

</script>
{% endblock %}